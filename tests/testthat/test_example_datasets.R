context("Example Datasets")

test_that("Replicate Table 4 of Acemoglu et al (2001)", {
  attach(colonial)
  b <- function(reg) as.numeric(round(coefficients(reg), 2)[2])
  SE <- function(reg) round(summary(reg)$coefficients[2,2], 2)
  OLS1 <- lm(logpgp95 ~ avexpr)
  OLS2 <- lm(logpgp95 ~ avexpr + lat_abst)
  IV1 <- sem::tsls(logpgp95 ~ avexpr, ~ logem4)
  IV2 <- sem::tsls(logpgp95 ~ avexpr + lat_abst, ~ logem4 + lat_abst)
  detach(colonial)
  expect_equal(0.52, b(OLS1))
  expect_equal(0.06, SE(OLS1))
  expect_equal(0.47, b(OLS2))
  expect_equal(0.06, SE(OLS2))
  expect_equal(0.94, b(IV1))
  expect_equal(0.16, SE(IV1))
  expect_equal(1, b(IV2))
  expect_equal(0.22, SE(IV2))
})
