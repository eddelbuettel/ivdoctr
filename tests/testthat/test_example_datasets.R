context("Example Datasets")

test_that("Replicate results of Acemoglu et al (2001)", {
  OLS1 <- lm(logpgp95 ~ avexpr, colonial)
  b_OLS1 <- as.numeric(round(coefficients(OLS1), 2)[2])
  expect_equal(0.52, b_OLS1)
  OLS2 <- lm(logpgp95 ~ avexpr + lat_abst, colonial)
  b_OLS2 <- as.numeric(round(coefficients(OLS2), 2)[2])
  expect_equal(0.47, b_OLS2)
  IV1 <- sem::tsls(logpgp95 ~ avexpr, ~ logem4, colonial)
  b_IV1 <- as.numeric(round(coefficients(IV1), 2)[2])
  expect_equal(0.94, b_IV1)
  IV2 <- sem::tsls(logpgp95 ~ avexpr + lat_abst, ~ logem4 + lat_abst, colonial)
  b_IV2 <- as.numeric(round(coefficients(IV2), 2)[2])
  expect_equal(1.00, b_IV2)
})
